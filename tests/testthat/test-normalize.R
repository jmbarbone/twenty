test_that("normalize()", {
  x <- c(0.23, 0.32, 0.12, 0.61, 0.26, 0.24, 0.23, 0.32, 0.29, 0.27)
  obj <- normalize(x)
  exp <- c(0.224489795918367, 0.408163265306122, 0, 1, 0.285714285714286,
           0.244897959183673, 0.224489795918367, 0.408163265306122, 0.346938775510204,
           0.306122448979592)
  expect_equal(obj, exp)

  obj <- normalize(x, range = 0:2)
  exp <- c(0.115, 0.16, 0.06, 0.305, 0.13, 0.12, 0.115, 0.16, 0.145, 0.135)
  expect_equal(obj, exp)

  obj <- normalize(x, bounds = 0:10)
  exp <- c(2.24489795918367, 4.08163265306122, 0, 10, 2.85714285714286,
           2.44897959183673, 2.24489795918367, 4.08163265306122, 3.46938775510204,
           3.06122448979592)
  expect_equal(obj, exp)

  obj <- normalize(x, range = 0:2, bounds = 0:10)
  exp <- c(1.15, 1.6, 0.6, 3.05, 1.3, 1.2, 1.15, 1.6, 1.45, 1.35)
  expect_equal(obj, exp)

  # maintains matrix
  mat <- structure(c(0.24, 0.92, 0.05, 0.37, 0.19, 0.69, 0.43, 0.22, 0.85,
                     0.73, 0.89, 0.68, 0.57, 0.89, 0.61, 0.98, 0.75, 0.37, 0.24, 0.24,
                     0.34, 0.8, 0.25, 0.46, 0.03, 0.71, 0.79, 0.56, 0.83, 0.97), dim = c(10L, 3L))
  obj <- normalize(mat, bounds = -1:1)
  exp <- structure(c(-0.557894736842105, 0.873684210526316, -0.957894736842105,
                     -0.284210526315789, -0.663157894736842, 0.389473684210526, -0.157894736842105,
                     -0.6, 0.726315789473684, 0.473684210526316, 0.810526315789474,
                     0.368421052631579, 0.136842105263158, 0.810526315789474, 0.221052631578947,
                     1, 0.515789473684211, -0.284210526315789, -0.557894736842105,
                     -0.557894736842105, -0.347368421052631, 0.621052631578948, -0.536842105263158,
                     -0.094736842105263, -1, 0.431578947368421, 0.6, 0.115789473684211,
                     0.684210526315789, 0.978947368421053), dim = c(10L, 3L))
  expect_equal(obj, exp)

  obj <- normalize(as.data.frame(mat), bounds = -1:1)
  exp <- structure(
    list(
      V1 = c(-0.563218390804598, 1, -1, -0.264367816091954, -0.67816091954023, 0.471264367816092, -0.126436781609195, -0.609195402298851, 0.839080459770115, 0.563218390804598),
      V2 = c(0.756756756756757, 0.189189189189189, -0.108108108108108, 0.756756756756757, 0, 1, 0.378378378378379, -0.648648648648649, -1, -1),
      V3 = c(-0.340425531914893, 0.638297872340426, -0.531914893617021, -0.0851063829787232, -1, 0.446808510638298, 0.617021276595745, 0.127659574468085, 0.702127659574468, 1)
    ),
    row.names = c(NA, -10L),
    class = "data.frame"
  )
  expect_equal(obj, exp)
})
